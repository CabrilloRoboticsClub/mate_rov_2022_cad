DRIVER
  os.environ['SMA_TSO_COSMOS_ELEMAT'] = '1'
  driver.registerSaveRule( UpdateRules.COPY, CheckPoints.ITER_COMPLETE, EventTimes.LAST, [ '*.ste*' ], 'SAVE.ste', '' )
  driver.registerSaveRule( UpdateRules.COPY, CheckPoints.ITER_COMPLETE, EventTimes.LAST, [ '*.lcd*' ], 'SAVE.ste', '' )
  driver.registerSaveRule( UpdateRules.COPY, CheckPoints.ITER_COMPLETE, EventTimes.LAST, [ '*.lcm*' ], 'SAVE.ste', '' )
END_

FEM_INPUT
  ID_NAME = nut-rail_trasintion-Topology_Study_1_1
  FILE = nut-rail_trasintion-Topology Study 1.NOD
END_

*SET_DB,rint,130,1

GROUP_DEF
  ID_NAME = FROZEN_AREA_ELEMS_GRP_1
  TYPE=ELEM
  FORMAT=LIST
  LIST_BEGIN
32,332,474,1488,1509,1768,1861,1932,2123,2357,2429,2702,2843,2856,3043,3743,3756,3769,3778,
3816,3821,3855,3872,3880,3882,3885,3981,3982,4002,4037,4048,4056,4101,4107,4109,4111,4191,
4211,4225,4233,4252,4301,4303,4338,4349,4396,4397,4399,4411,4412,4421,4423,4424,4428,4446,
4454,4475,4487,4489,4493,4513,4522,4524,4531,4541,4543,4545,4598,4615,4624,4625,4637,4638,
4698,4699,4720,4722,4731,4749,4774,4779,4783,4795,4796,4799,4834,4835,4842,4847,4871,4892,
4900,4902,4906,4910,4932,4934,4943,4947,4951,4962,4965,4976,4985,4986,4987,5002,5006,5010,
5012,5016,5017,5044,5047,5057,5058,5063,5067,5070,5097,5099,5101,5104,5109,5116,5117,5121,
5123,5130,5137,5143,5203,5236,5238,5243,5248,5256,5268,5278,5283,5294,5328,5334,5358,5361,
5385,5390,5411,5413,5417,5422,5489,5505,5519,5521,5527,5547,5553,5555,5562,5576,5579,5601,
5627,5642,5644,5654,5667,5671,5674,5690,5694,5707,5759,5760,5773,5775,5814,5815,5838,5839,
5854,5868,5875,5881,5884,5885,5888,5894,5924,5962,5965,5970,6009,6019,6022,6044,6056,6087,
6095,6097,6098,6109,6123,6130,6138,6149,6158,6159,6162,6173,6177,6182,6193,6208,6209,6216,
6226,6228,6280,6301,6318,6344,6405,6412,6416,6473,6489,6519,6546,6547,6593,6594,6614,6628,
6648,6663,6698,6710,6729,6730,6738,6740,6743,6757,6764,6771,6787,6795,6801,6811,6848,6854,
6855,6867,6875,6876,6891,6916,6930,6945,6947,6959,6962,6979,6984,6993,7042,7056,7073,7078,
7084,7088,7089,7105,7117,7120,7132,7148,7161,7162,7172,7177,7271,7272,7291,7311,7343,7358,
7375,7404,7421,7482,7509,7579,7618,7645,7696,7703,7720,7766,7829,7864,7873,7922,7937,7938,
7955,7990,8009,8023,8024,8062,8067,8073,8089,8104,8106,8107,8133,8158,8169,8174,8186,8215,
8222,8252,8253,8260,8267,8279,8281,8285,8292,8298,8309,8328,8329,8332,8342,8362,8386,8387,
8393,8414,8415,8416,8419,8423,8427,8431,8433,8434,8443,8449,8457,8460,8474,8476,8478,8479,
8483,8488,8490,8495,8496,8497,8498,8510,8512,8513,8544,8561,8581,8597,8608,8609,8636,8641,
8643,8644,8682,8688,8712,8755,8756,8776,8780,8784,8800,8817,8830,8832,8837,8857,8862,8865,
8872,8881,8898,8901,8902,8905,9174,9180,9183,9185,9186,9190,9192,9199,9217,9218,9220,9225,
9227,9265,9266,9275,9279,9281,9295,9296,9310,9336,9351,9359,9374,9389,9391,9394,9396,9400,
9413,9429,9452,9455,9458,9470,9480,9499,9500,9536,9544,9580,9607,9617,9624,9634,9685,9689,
9700,9708,9714,9717,9718,9721,9736,9784,9794,9799,9808,9819,9822,9823,9832,9833,9835,9836,
9837,9838,9839,9845,9846,9850,9854,9855,9858,9859,9864,9867,9868,9871,9872,9881,9897,9915,
9955,9987,9991,10021,10026,10057,10093,10094,10113,10408,10409,10413,10420,10424,10426,10427,
10450,10532,10546,10571,10574,10575,10581,10616,10617,10622,10630,10633,10650,10652,10656,
10672,10673,10677,10696,10703,10708,10729,10738,10740,10746,10772,10782,10788,10790,10921,
10927,10942,10967,11091,11101,11119,11145,11174,11181,11182,11188,11189,11193,11195,11207,
11219,11234,11243,11246,11260,11288,11293,11296,11388,11410,11411,11414,11454,11464,11465,
11469,11490,11491,11492,11620,11629,11638,11645,11646,11668,11683,11705,11711,11719,11721,
11733,11735,11746,11755,11759,11762,11769,11772,11807,11808,11831,11848,11882,11896,11898,
11907,11914,11928,11932,11946,11953,11955,11957,11958,11961,11962,11988,11994,12013,12015,
12034,12043,12047,12073,12111,12148,12149,12154,12177,12216,12301,12305,12308,12309,12319,
12320,12325,12328,12348,12371,12385,12394,12395,12399,12413,12498,12504,12519,12520,12529,
12564,12572,12584,12586,12587,12591,12609,12610,12619,12621,12622,12753,12776,12783,12816,
12851,12852,12860,12912,12962,12976,12977,13007,13078,13089,13092,13094,13095,13096,13101,
13103,13107,13109,13156,13157,13161,13169,13176,13183,13184,13207,13211,13310,13321,13333,
13354,13355,13356,13358,13360,13363,13401,13439,13475,13530,13619,13661,13922,14022,14024,
14026,14102,14123,14145,14147,14148,14149,14165,14166,14167,14194,14305,14332,14340,14341,
14353,14361,14366,14381,14429,14432,14470,14481,14484,14517,14520,14521,14529,14530,14533,
14535,14556,14569,14595,14598,14603,14608,14832,14835,14928,14930,14932,14991,15070,15098,
15125,15154,15155,15214,15250,15252,15331,15332,15337,15343,15348,15408,15409,15423,15425,
15476,15514,15551,15577,15610,15617,15627,15689,15738,15818,15883,15885,15995,16036,16105,
16124,16128,16129,16158,16206,16237,16244,16248,16253,16256,16388,16414,16421,16506,16576,
16612,16694,16851,16852,16853,16857,16862,16938,16943,16944,16950,17048,17051,17061,17142,
17156,17159,17190,17543,17575,17664,17938,17944,17959,17964,17971,17983,18002,18003,18005,
18012,18014,18023,18032,18033,18034,18035,18038,18048,18051,18054,18056,18059,18112,18129,
18133,18140,18151,18156,18160,18195,18198,18199,18237,18648,18656,18666,18669,18704,18705,
18707,18715,18718,18783,18856,19355,19458,19474,19581,19805,20030,20031,20034,20040,20120,
20136,20137,20147,20220,20276,20368,20427,20497,20514,20530,20560,20571,20731,20738,20743,
20847,20861,20862,20868,20906,20908,20918,20920,20921,20922,20927,20928,20934,20944,20946,
20965,21028,21030,21080,21107,21138,21147,21184,21185,21202,21203,21221,21224,21245,21271,
21273,21275,21281,21340,21341,21351,21353,21411,21478,21579,21672,21785,21800,21860,21863,
21867,21910,22071,22080,22117,22119,22125,22471,22563,22580,22766,22767,22830,22878,22986,
23068,23087,23102,23162,23222,23227,23246,23262,23288,23304,23305,23313,23392,23394,23419,
23526,23555,23606,23673,23895,23911,23988,24013,24119,24153,24156,24158,24210,24336,24345,
24347,24447,24489,24564,24567,24633,24652,24804,24811,24897,24906,25045,25048,25061,25100,
25101,25106,25206,25269,25324,25325,25349,25473,25661,25713,25716,25767,25777,26036,26042,
26107,26109,26161,26202,26204,26208,26243,26244
END_

! ----------------------------------------------------------------
!
! Design Response: Stiffness_Measure
!
DRESP
  ID_NAME = Stiffness_Measure
  LIST = NO_LIST
  DEF_TYPE = SYSTEM
  EL_GROUP = ALL_ELEMENTS
  TYPE = ENERGY_STIFF_MEASURE
  GROUP_OPER = SUM
  LC_SEL = SUM 
  LC_SET = STATIC, ALL, ALL, MAX
END_

! ----------------------------------------------------------------
!
! Design Response: Mass_DResp_1
!
DRESP
  ID_NAME = Mass_DResp_1
  LIST = NO_LIST
  DEF_TYPE = SYSTEM
  EL_GROUP = ALL_ELEMENTS
  TYPE = WEIGHT
  GROUP_OPER = SUM
END_

! ----------------------------------------------------------------
!
!
! Design Area: Task1_DESIGN_AREA
!
DV_TOPO
  ID_NAME = Task1_DESIGN_AREA
  EL_GROUP = ALL_ELEMENTS
END_

! ----------------------------------------------------------------
!
! Objective Function: StiffnessEnergy_Obj_Func
!
OBJ_FUNC
  ID_NAME = StiffnessEnergy_Obj_Func
  DRESP = Stiffness_Measure, 1.0
  TARGET = MIN
END_

! ----------------------------------------------------------------
!
! Constraint: Mass_Constraint_1
!
CONSTRAINT
  ID_NAME = Mass_Constraint_1
  DRESP = Mass_DResp_1
  MAGNITUDE = REL
  LE_VALUE = 0.7
END_

! ----------------------------------------------------------------
!
! Geometric Restriction: Frozen_ManufacConstraint_2
!
DVCON_TOPO
  ID_NAME = Frozen_ManufacConstraint_2
  EL_GROUP = FROZEN_AREA_ELEMS_GRP_1
  CHECK_TYPE = FROZEN
END_

! ----------------------------------------------------------------
!
!
! Optimize: OPTIMIZE_1_TOPOLOGY_OPTIMIZATION_CONTROLLER 
!
OPTIMIZE
  ID_NAME = OPTIMIZE_1_TOPOLOGY_OPTIMIZATION_SENSITIVITY
  DV = Task1_DESIGN_AREA
  OBJ_FUNC = StiffnessEnergy_Obj_Func
  DVCON = Frozen_ManufacConstraint_2
  CONSTRAINT = Mass_Constraint_1
  STRATEGY = TOPO_SENSITIVITY
END_

OPT_PARAM
  ID_NAME = OPTIMIZE_1_TOPOLOGY_OPTIMIZATION_SENSITIVITY_OPT_PARAM_
  OPTIMIZE = OPTIMIZE_1_TOPOLOGY_OPTIMIZATION_SENSITIVITY
  DV_UPDATE_STRATEGY = CSA
  STABILIZATION = YES
  AUTO_FROZEN = BOTH
  AUTO_FROZEN_CON = BOTH
  STOP_CRITERION_LEVEL = BOTH
  STOP_CRITERION_OBJ = 0.001
  STOP_CRITERION_DENSITY = 0.005
END_

STOP
  ID_NAME = Task-1_GLOBAL_STOP_CONDITION_
  ITER_MAX = 75
END_

